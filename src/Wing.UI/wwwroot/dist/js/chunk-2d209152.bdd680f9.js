(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d209152"],{a816:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",[a("template",{slot:"header"},[a("div",[a("el-input",{staticClass:"search",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入服务名称"},on:{change:e.search},model:{value:e.pageModel.data.name,callback:function(t){e.$set(e.pageModel.data,"name",t)},expression:"pageModel.data.name"}}),a("el-select",{staticClass:"search",attrs:{placeholder:"请选择健康状态",clearable:""},on:{change:e.search},model:{value:e.pageModel.data.status,callback:function(t){e.$set(e.pageModel.data,"status",t)},expression:"pageModel.data.status"}},e._l(e.statusOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-select",{staticClass:"search",attrs:{placeholder:"请选择服务类别",clearable:""},on:{change:e.search},model:{value:e.pageModel.data.serviceType,callback:function(t){e.$set(e.pageModel.data,"serviceType",t)},expression:"pageModel.data.serviceType"}},e._l(e.serviceOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-select",{staticClass:"search",attrs:{placeholder:"请选择负载均衡",clearable:""},on:{change:e.search},model:{value:e.pageModel.data.loadBalancer,callback:function(t){e.$set(e.pageModel.data,"loadBalancer",t)},expression:"pageModel.data.loadBalancer"}},e._l(e.loadBalancerOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-button",{staticClass:"search",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return t.preventDefault(),e.search(t)}}},[e._v("查询")])],1)]),a("div",{staticClass:"table-container"},[a("vxe-table",{ref:"xTable",staticClass:"mytable-scrollbar",attrs:{border:"",resizable:"",height:"100%",size:"medium",align:"center","highlight-hover-row":"","highlight-current-row":"","show-overflow":"","auto-resize":"","keep-source":"",stripe:"","edit-config":{trigger:"click",mode:"row",showStatus:!0},loading:e.loading,data:e.services.items,"mouse-config":{selected:!0}}},[a("vxe-column",{attrs:{type:"seq",width:"60"}}),a("vxe-column",{attrs:{field:"name",title:"服务名称",sortable:""}}),a("vxe-column",{attrs:{field:"address",title:"服务地址",sortable:""}}),a("vxe-column",{attrs:{field:"status",title:"健康状态",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[0==l.status?a("el-tag",{attrs:{type:"success"}},[e._v("健康")]):1==l.status?a("el-tag",{attrs:{type:"warning"}},[e._v("警告")]):2==l.status?a("el-tag",{attrs:{type:"danger"}},[e._v("死亡")]):3==l.status?a("el-tag",{attrs:{type:"warning"}},[e._v("维护")]):e._e()]}}])}),a("vxe-column",{attrs:{field:"serviceType",title:"服务类别",formatter:["formatSelect",e.serviceOptions],sortable:""}}),a("vxe-column",{attrs:{field:"loadBalancer",title:"负载均衡",formatter:["formatSelect",e.loadBalancerOptions],sortable:""}}),a("vxe-column",{attrs:{field:"weight",title:"权重",sortable:""}}),a("vxe-column",{attrs:{field:"configKey",title:"配置Key",sortable:""}}),a("vxe-column",{attrs:{field:"developer",title:"负责人",sortable:""}}),a("vxe-column",{attrs:{title:"操作",width:"200",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-button",{staticStyle:{"margin-right":"5px"},attrs:{type:"success"},on:{click:function(t){return t.preventDefault(),e.toConfig(l)}}},[e._v("配置")]),a("el-popconfirm",{attrs:{title:"确定要删除吗？"},on:{onConfirm:function(t){return e.remove(l)}}},[a("el-button",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[e._v("删除")])],1)]}}])})],1)],1),a("template",{slot:"footer"},[a("el-pagination",{attrs:{"current-page":e.pageModel.pageIndex,"page-size":e.pageModel.pageSize,"page-sizes":[15,25,35,45],layout:"total, sizes, prev, pager, next, jumper",total:e.services.totalCount},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1)],2)},r=[],s=(a("b0c0"),a("ac1f"),a("841c"),a("96cf"),a("1da1")),n={name:"service-detail",data:function(){return{loading:!1,services:[],pageModel:{pageSize:15,pageIndex:1,data:{name:"",serviceType:null,loadBalancer:null,status:null}},serviceOptions:[{value:0,label:"http"},{value:1,label:"grpc"}],statusOptions:[{value:0,label:"健康"},{value:1,label:"警告"},{value:2,label:"死亡"},{value:3,label:"维护"}],loadBalancerOptions:[{value:0,label:"轮询"},{value:1,label:"加权轮询"},{value:2,label:"最小连接数"}]}},mounted:function(){var e=this;this.Bus.on("serviceNameToDetail",(function(t){e.pageModel.data.name=t,e.search()}))},created:function(){this.search()},beforeDestroy:function(){this.Bus.off("serviceNameToDetail")},methods:{search:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$api.SERVICE_DETAIL(e.pageModel);case 3:e.services=t.sent,e.loading=!1;case 5:case"end":return t.stop()}}),t)})))()},toConfig:function(e){var t=this;this.$emit("show",1);var a=setTimeout((function(){t.Bus.emit("serviceNameToConfig",e.configKey),clearTimeout(a)}))},remove:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(2===e.status){a.next=3;break}return t.$message.error("仅能删除状态为“已死亡”的服务节点！"),a.abrupt("return");case 3:return a.next=5,t.$api.SERVICE_DELETE({serviceId:e.id});case 5:return l=a.sent,l?t.$message({type:"success",message:"删除成功！"}):t.$message.error("删除失败，请稍后重试！"),a.next=9,t.search();case 9:case"end":return a.stop()}}),a)})))()},sizeChange:function(e){this.pageModel.pageSize=e,this.search()},currentChange:function(e){this.pageModel.pageIndex=e,this.search()}}},o=n,i=a("2877"),c=Object(i["a"])(o,l,r,!1,null,"2bdf03f0",null);t["default"]=c.exports}}]);