(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d191759"],{"0522":function(e,t,n){},"44e7":function(e,t,n){var r=n("861d"),a=n("c6b6"),i=n("b622"),o=i("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==a(e))}},"59ac":function(e,t,n){"use strict";var r=n("0522"),a=n.n(r);a.a},"5a34":function(e,t,n){var r=n("44e7");e.exports=function(e){if(r(e))throw TypeError("The method doesn't accept regular expressions");return e}},"8a79":function(e,t,n){"use strict";var r=n("23e7"),a=n("06cf").f,i=n("50c4"),o=n("5a34"),c=n("1d80"),s=n("ab13"),u=n("c430"),l="".endsWith,d=Math.min,g=s("endsWith"),p=!u&&!g&&!!function(){var e=a(String.prototype,"endsWith");return e&&!e.writable}();r({target:"String",proto:!0,forced:!p&&!g},{endsWith:function(e){var t=String(c(this));o(e);var n=arguments.length>1?arguments[1]:void 0,r=i(t.length),a=void 0===n?r:d(i(n),r),s=String(e);return l?l.call(t,s,a):t.slice(a-s.length,a)===s}})},ab13:function(e,t,n){var r=n("b622"),a=r("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[a]=!1,"/./"[e](t)}catch(r){}}return!1}},eb43:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("d2-container",[n("template",{slot:"header"},[n("div",[n("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入服务名称"},on:{change:e.search},model:{value:e.serviceName,callback:function(t){e.serviceName=t},expression:"serviceName"}}),n("el-button",{staticClass:"search",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return t.preventDefault(),e.search(t)}}},[e._v("查询")]),n("el-button",{attrs:{type:"primary",loading:e.saveLoading},on:{click:function(t){return e.save()}}},[e._v("保存")]),n("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:function(t){return e.add()}}},[e._v("新增")]),n("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{title:"确定要删除吗？"},on:{onConfirm:function(t){return e.remove()}}},[n("el-button",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[e._v("删除")])],1)],1)]),n("div",[n("el-row",[n("el-col",{attrs:{span:5}},[n("div",{staticClass:"table-container"},[n("vxe-table",{ref:"config",attrs:{border:"",resizable:"",height:"100%",size:"medium",align:"left","highlight-hover-row":"","highlight-current-row":"","show-overflow":"","auto-resize":"","keep-source":"",stripe:"","edit-config":{trigger:"click",mode:"cell"},loading:e.loading,data:e.configData,"mouse-config":{selected:!0}},on:{"current-change":e.rowChange}},[n("vxe-column",{attrs:{field:"key",title:"配置Key","edit-render":{autofocus:".vxe-input--inner"}},scopedSlots:e._u([{key:"edit",fn:function(t){var r=t.row;return[n("vxe-input",{attrs:{type:"text"},model:{value:r.key,callback:function(t){e.$set(r,"key",t)},expression:"row.key"}})]}}])})],1)],1)]),n("el-col",{attrs:{span:19}},[n("div",{staticStyle:{"margin-left":"20px"}},[n("el-input",{attrs:{type:"textarea",rows:28,placeholder:e.placeholder,disabled:e.disabled},model:{value:e.currentRow.value,callback:function(t){e.$set(e.currentRow,"value",t)},expression:"currentRow.value"}})],1)])],1)],1),n("template",{slot:"footer"},[n("el-pagination",{attrs:{"current-page":e.pageModel.pageSize,"page-size":e.pageModel.pageIndex,"page-sizes":[15,25,35,45],layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.sizeChange,"current-change":e.currentChange}})],1)],2)},a=[],i=(n("c740"),n("a434"),n("ac1f"),n("8a79"),n("841c"),n("96cf"),n("1da1")),o={name:"service-config",data:function(){return{saveLoading:!1,loading:!1,services:[],pageModel:{pageSize:15,pageIndex:1,data:""},disabled:!0,configData:[],currentRow:{key:"",value:""},placeholder:"请输入配置Value",serviceName:"",totalCount:0,id:1}},mounted:function(){},created:function(){this.search()},methods:{rowChange:function(e){e.row.key.endsWith("/")?(this.placeholder="该配置Key是目录，不允许编辑配置Value",this.disabled=!0):(this.placeholder="请输入配置内容",this.disabled=!1),this.currentRow=e.row},save:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<e.configData.length)){t.next=9;break}if(r=e.configData[n],r.key){t.next=6;break}return e.$message.error("配置key必填"),t.abrupt("return");case 6:n++,t.next=1;break;case 9:return e.saveLoading=!0,t.next=12,e.$api.CONFIG_SAVE(e.configData).catch((function(t){e.saveLoading=!1}));case 12:if(a=t.sent,e.saveLoading=!1,!a){t.next=18;break}return e.$notify({title:"成功",message:"保存成功",type:"success",duration:2e3}),t.next=18,e.search();case 18:case"end":return t.stop()}}),t)})))()},search:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,e.pageModel.data=e.serviceName?e.serviceName:"/",t.next=4,e.$api.CONFIG_LIST(e.pageModel);case 4:if(n=t.sent,e.loading=!1,console.log("服务配置",n),e.totalCount=n.totalCount,n.items){t.next=10;break}return t.abrupt("return");case 10:for(r in e.configData=[],n.items)e.configData.push({key:r,value:n.items[r]});e.configData.length>0&&(e.$refs.config.setCurrentRow(e.configData[0]),e.rowChange({row:e.configData[0]}));case 13:case"end":return t.stop()}}),t)})))()},sizeChange:function(e){this.pageModel.pageSize=e,this.search()},currentChange:function(e){this.pageModel.pageIndex=e,this.search()},add:function(){this.id++,this.configData.push({id:this.id,key:"",value:""})},remove:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.currentRow.id){t.next=3;break}return e.configData.splice(e.configData.findIndex((function(t){return t.id===e.currentRow.id})),1),t.abrupt("return");case 3:return t.next=5,e.$api.CONFIG_DELETE({key:e.currentRow.key});case 5:return n=t.sent,n?e.$message({type:"success",message:"删除成功！"}):e.$message.error("删除失败，请稍后重试！"),t.next=9,e.search();case 9:case"end":return t.stop()}}),t)})))()}}},c=o,s=(n("59ac"),n("2877")),u=Object(s["a"])(c,r,a,!1,null,"7c0450af",null);t["default"]=u.exports}}]);